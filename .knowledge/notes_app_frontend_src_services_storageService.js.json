{"is_source_file": true, "format": "JavaScript", "description": "This file provides a storage service abstraction for notes, supporting both localStorage and Supabase backend, with functions for listing, creating, updating, deleting, and synchronizing notes. It includes environment variable handling, dynamic import of the Supabase client, and fallback mechanisms.", "external_files": ["@supabase/supabase-js"], "external_methods": ["import('@supabase/supabase-js').createClient"], "published": ["getStorageProvider", "localProvider", "supabaseProvider", "getStorageInfo"], "classes": [], "methods": [{"name": "getSupabase", "description": "Dynamically imports and creates or retrieves a singleton Supabase client instance if configured."}, {"name": "getStorageProvider", "description": "Returns the active storage provider based on environment configuration."}, {"name": "localProvider.list", "description": "Retrieves notes from localStorage."}, {"name": "localProvider.saveAll", "description": "Saves all notes to localStorage."}, {"name": "toAppNote", "description": "Converts database row to application note format with timestamp conversions."}, {"name": "toDbPatch", "description": "Prepares a note patch object for database update, setting updated_at timestamp."}, {"name": "supabaseProvider.list", "description": "Fetches notes from Supabase 'notes' table, falling back to localStorage on error."}, {"name": "supabaseProvider.create", "description": "Creates a new note in Supabase 'notes' table."}, {"name": "supabaseProvider.update", "description": "Updates a note in Supabase 'notes' table."}, {"name": "supabaseProvider.remove", "description": "Deletes a note from Supabase 'notes' table."}, {"name": "supabaseProvider.saveAll", "description": "Synchronizes the entire list of notes with Supabase, performing upsert and delete operations."}, {"name": "getStorageInfo", "description": "Returns a string indicating whether storage is via Supabase or localStorage."}], "calls": ["import('@supabase/supabase-js').createClient", "localStorage.getItem", "localStorage.setItem", "JSON.parse", "JSON.stringify", "new Date", "sb.from", "sb.from().select", "sb.from().insert", "sb.from().update", "sb.from().delete", "sb.from().upsert"], "search-terms": ["storageService", "Supabase CRUD", "localStorage fallback", "notes table", "dynamic import", "environment variables", "notes synchronization"], "state": 2, "file_id": 16, "knowledge_revision": 64, "git_revision": "2f9de14ff05c69bff849ae8cb1a4be8fc18e13c9", "revision_history": [{"31": ""}, {"48": "13f55feff66c91ffe231e20e9558589b6eb0cf52"}, {"50": "13f55feff66c91ffe231e20e9558589b6eb0cf52"}, {"64": "2f9de14ff05c69bff849ae8cb1a4be8fc18e13c9"}], "ctags": [], "filename": "notes_app_frontend/src/services/storageService.js", "format-version": 4, "code-base-name": "https://github.com/kavia-common/personal-notes-web-app-186776-186785.git:kavia-main"}